{% extends 'base.html' %}

{% block content %}
<section class="bg-white dark:bg-gray-900 py-8 lg:py-16">
    <div class="px-4 mx-auto max-w-screen-xl lg:px-6">
        <h1 class="text-4xl font-bold mb-8 dark:text-white">Finance Dashboard</h1>
        
        <div class="grid gap-6 md:grid-cols-3 mb-8">
            <div class="bg-green-50 dark:bg-green-900 rounded-lg p-6">
                <h3 class="text-gray-600 dark:text-gray-400 mb-2">Total Income</h3>
                <p class="text-3xl font-bold text-green-600 dark:text-green-400">${{ total_income|floatformat:2 }}</p>
            </div>
            <div class="bg-red-50 dark:bg-red-900 rounded-lg p-6">
                <h3 class="text-gray-600 dark:text-gray-400 mb-2">Total Expenses</h3>
                <p class="text-3xl font-bold text-red-600 dark:text-red-400">${{ total_expenses|floatformat:2 }}</p>
            </div>
            <div class="bg-blue-50 dark:bg-blue-900 rounded-lg p-6">
                <h3 class="text-gray-600 dark:text-gray-400 mb-2">Balance</h3>
                <p class="text-3xl font-bold text-blue-600 dark:text-blue-400">${{ balance|floatformat:2 }}</p>
            </div>
        </div>
        
        <div class="mb-8">
            <canvas id="financeChart" width="400" height="200"></canvas>
        </div>
        
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold dark:text-white">Recent Transactions</h2>
            <a href="{% url 'transaction_create' %}" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Add Transaction</a>
        </div>
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const monthlyData = {{ monthly_data|safe }};
const ctx = document.getElementById('financeChart').getContext('2d');
const labels = Object.keys(monthlyData);
const incomeData = labels.map(month => monthlyData[month].income);
const expenseData = labels.map(month => monthlyData[month].expense);

new Chart(ctx, {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Income',
            data: incomeData,
            borderColor: 'rgb(34, 197, 94)',
            backgroundColor: 'rgba(34, 197, 94, 0.1)',
        }, {
            label: 'Expenses',
            data: expenseData,
            borderColor: 'rgb(239, 68, 68)',
            backgroundColor: 'rgba(239, 68, 68, 0.1)',
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
</script>
{% endblock %}









